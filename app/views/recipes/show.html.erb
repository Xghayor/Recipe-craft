<section class="show_recipe">

  <%= link_to 'Back to Recipes', recipes_path, class: 'btn' %>

  <article class="upper_section">
    <h2 class="recipe_heading"><%=@recipe.name %></h2>

    <div class="recipe_details">
      <div class="preparation_public">
        <p class="preparation_time"><%= "Preparation Time: #{@recipe.preparation_time} hour"%></p>
        <% if !current_user.nil? && current_user.id == @recipe.user_id %>
          <%= form_for @recipe do |f| %>
            <div class="public_btn_container">
              <%= f.label :public, class: "visibility_toggle_lable", for: "visibility-toggle" %>
              <%= f.check_box :public, id: "visibility-toggle", class: "visibility_toggle_input" %>
            </div>

            <%= f.submit "Update Visibility", class: "btn" %>
          <%end%>
        <% end %>
      </div>
      <p><%= "Cooking Time: #{@recipe.cooking_time} hour"%></p>
      <p><%= "Steps to prepare: #{@recipe.description}"%></p>
    </div>
  </article>
  <% if !current_user.nil? && current_user.id == @recipe.user_id %>
    <div class="buttons">
      <%= link_to 'Generate Shopping List', recipe_shopping_list_path(@recipe.id), class: 'btn' %>
      <%= link_to 'Add Ingredient', new_recipe_recipe_food_path(@recipe.id), class: 'btn' %>
    </div>
  <%end%>
  <table class="table">
    <thead>
      <tr>
        <th>Food</th>
        <th>Quantity</th>
        <th>Value</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% @recipe.foods.each do  |food| %>
        <tr>
          <td><%= food.name %></td>
          <%@quantity = RecipeFood.find_by(food_id: food.id).quantity%>
          <td><%= @quantity %></td>
          <td><%= "$ #{food.price * @quantity}" %></td>
          <% if !current_user.nil? && current_user.id == @recipe.user_id %>
            <td>
              <%= link_to "Modify", edit_recipe_recipe_food_path(@recipe.id, food.id), class:'btn' %>
              <%= button_to "Remove", recipe_recipe_food_path(@recipe.id, food.id), method: :delete, class:'btn' %>
            </td>
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>
</section>
